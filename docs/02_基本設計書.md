# 02. åŸºæœ¬è¨­è¨ˆæ›¸

## Bistro Lumiere - ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³åº§å¸­äºˆç´„ã‚·ã‚¹ãƒ†ãƒ 

---

## 1. å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```mermaid
graph TB
    subgraph "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ï¼‰"
        FE["ğŸŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰<br/>Vanilla HTML/CSS/JS<br/>Vercel ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°"]
    end

    subgraph "ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆSpring Bootï¼‰"
        CTRL["ğŸ“‹ Controllerå±¤<br/>@RestController<br/>HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä»˜"]
        SVC["âš™ï¸ Serviceå±¤<br/>@Service<br/>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯"]
        REPO["ğŸ—„ï¸ Repositoryå±¤<br/>@Repository<br/>DB ã‚¢ã‚¯ã‚»ã‚¹"]
    end

    subgraph "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"
        DB["ğŸ˜ Neon PostgreSQL<br/>Serverless<br/>Singapore ãƒªãƒ¼ã‚¸ãƒ§ãƒ³"]
    end

    FE -- "HTTP/JSON<br/>fetch API" --> CTRL
    CTRL --> SVC
    SVC --> REPO
    REPO -- "JDBC/JPA" --> DB
    DB --> REPO
    REPO --> SVC
    SVC --> CTRL
    CTRL -- "JSON ãƒ¬ã‚¹ãƒãƒ³ã‚¹" --> FE
```

**ãƒã‚¤ãƒ³ãƒˆ: ãªãœ3å±¤ã«åˆ†ã‘ã‚‹ã®ã‹ï¼Ÿ**

> ä¾‹ãˆè©±ï¼šãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã«ä¾‹ãˆã‚‹ã¨
> - **Controller**: ã‚¦ã‚§ã‚¤ã‚¿ãƒ¼ï¼ˆãŠå®¢æ§˜ã®æ³¨æ–‡ã‚’å—ã‘å–ã‚Šã€æ–™ç†ã‚’æä¾›ï¼‰
> - **Service**: æ–™ç†é•·ï¼ˆãƒ¬ã‚·ãƒ”ã¨èª¿ç†ãƒ«ãƒ¼ãƒ«ã‚’çŸ¥ã£ã¦ã„ã‚‹ï¼‰
> - **Repository**: é£Ÿæåº«ç®¡ç†è€…ï¼ˆé£Ÿæã®å‡ºã—å…¥ã‚Œã ã‘ã«é›†ä¸­ï¼‰
>
> å„å±¤ãŒå½¹å‰²ã‚’æŒã¤ã“ã¨ã§ã€å¤‰æ›´ãŒä»–å±¤ã«æ³¢åŠã—ã«ãããªã‚Šã¾ã™ã€‚

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| åŒºåˆ† | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å½¹å‰² |
|------|------|-----------|------|
| è¨€èª | Java | 17 | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºè¨€èª |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Spring Boot | 3.2.5 | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŸºç›¤ |
| ORM | Spring Data JPA / Hibernate | 6.x | DBæ“ä½œã®æŠ½è±¡åŒ– |
| ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | Jakarta Bean Validation | 3.x | å…¥åŠ›å€¤ãƒã‚§ãƒƒã‚¯ |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | Spring Security | 6.x | CSRFãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ |
| ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ« | Maven | 3.x | ä¾å­˜é–¢ä¿‚ç®¡ç†ãƒ»ãƒ“ãƒ«ãƒ‰ |
| DBï¼ˆæœ¬ç•ªï¼‰ | Neon PostgreSQL | - | ã‚¯ãƒ©ã‚¦ãƒ‰DB |
| DBï¼ˆãƒ†ã‚¹ãƒˆï¼‰ | H2 ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒª | 2.x | ãƒ†ã‚¹ãƒˆç”¨è»½é‡DB |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | Vanilla JS / CSS | ES2020 | UIå®Ÿè£… |
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ï¼ˆFEï¼‰ | Vercel | - | é™çš„ãƒ•ã‚¡ã‚¤ãƒ«CDNé…ä¿¡ |

---

## 3. API ä¸€è¦§

### ãƒ™ãƒ¼ã‚¹URL: `https://api.example.com/api`

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | æ©Ÿèƒ½ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ |
|--------|------|------|----------------|
| POST | `/reservations` | äºˆç´„ä½œæˆ | 201 Created / 400 / 409 |
| GET | `/reservations` | å…¨äºˆç´„ä¸€è¦§å–å¾— | 200 OK |
| GET | `/reservations/{id}` | äºˆç´„è©³ç´°å–å¾— | 200 / 404 |
| DELETE | `/reservations/{id}` | äºˆç´„ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆè«–ç†å‰Šé™¤ï¼‰ | 200 / 404 / 409 |
| GET | `/reservations/date?date=yyyy-MM-dd` | æ—¥ä»˜åˆ¥äºˆç´„ä¸€è¦§ | 200 |
| GET | `/reservations/availability?date=&time=` | ç©ºå¸­ç¢ºèª | 200 |

### ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼ˆäºˆç´„ä½œæˆï¼‰

```json
POST /api/reservations
Content-Type: application/json

{
  "guestName": "å±±ç”° å¤ªéƒ",
  "guestEmail": "yamada@example.com",
  "partySize": 2,
  "reservationDate": "2025-12-25",
  "reservationTime": "19:00:00",
  "specialRequest": "çª“éš›ã®å¸­ã‚’å¸Œæœ›ã—ã¾ã™"
}
```

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹ï¼ˆäºˆç´„ä½œæˆæˆåŠŸï¼‰

```json
HTTP/1.1 201 Created

{
  "id": 42,
  "guestName": "å±±ç”° å¤ªéƒ",
  "guestEmail": "yamada@example.com",
  "partySize": 2,
  "reservationDate": "2025-12-25",
  "reservationTime": "19:00:00",
  "status": "CONFIRMED",
  "specialRequest": "çª“éš›ã®å¸­ã‚’å¸Œæœ›ã—ã¾ã™",
  "createdAt": "2025-11-01T10:30:00"
}
```

### ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹ï¼ˆæº€å¸­ï¼‰

```json
HTTP/1.1 409 Conflict

{
  "status": 409,
  "errorCode": "FULLY_BOOKED",
  "message": "ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚2025å¹´12æœˆ25æ—¥ 19:00 ã¯æº€å¸­ã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚",
  "timestamp": "2025-11-01 10:30:00",
  "fieldErrors": null
}
```

---

## 4. ç”»é¢é·ç§»å›³

```mermaid
stateDiagram-v2
    [*] --> ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸: ã‚¢ã‚¯ã‚»ã‚¹

    state ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ {
        [*] --> äºˆç´„ã‚¿ãƒ–: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤º
        äºˆç´„ã‚¿ãƒ– --> ä¸€è¦§ã‚¿ãƒ–: ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯
        ä¸€è¦§ã‚¿ãƒ– --> äºˆç´„ã‚¿ãƒ–: ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯
    }

    äºˆç´„ã‚¿ãƒ– --> ç©ºå¸­ç¢ºèªä¸­: ç¢ºèªãƒœã‚¿ãƒ³æŠ¼ä¸‹
    ç©ºå¸­ç¢ºèªä¸­ --> äºˆç´„ã‚¿ãƒ–: çµæœè¡¨ç¤ºï¼ˆæ®‹å¸­æ•° or æº€å¸­ï¼‰

    äºˆç´„ã‚¿ãƒ– --> APIé€ä¿¡ä¸­: äºˆç´„ãƒœã‚¿ãƒ³æŠ¼ä¸‹\nï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³OKï¼‰
    äºˆç´„ã‚¿ãƒ– --> äºˆç´„ã‚¿ãƒ–: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³NG\nï¼ˆã‚¨ãƒ©ãƒ¼è¡¨ç¤ºï¼‰

    APIé€ä¿¡ä¸­ --> å®Œäº†ãƒ¢ãƒ¼ãƒ€ãƒ«: äºˆç´„æˆåŠŸ
    APIé€ä¿¡ä¸­ --> äºˆç´„ã‚¿ãƒ–: ã‚¨ãƒ©ãƒ¼è¡¨ç¤º\nï¼ˆæº€å¸­ãƒ»é€šä¿¡ã‚¨ãƒ©ãƒ¼ç­‰ï¼‰

    å®Œäº†ãƒ¢ãƒ¼ãƒ€ãƒ« --> äºˆç´„ã‚¿ãƒ–: é–‰ã˜ã‚‹

    ä¸€è¦§ã‚¿ãƒ– --> ã‚­ãƒ£ãƒ³ã‚»ãƒ«ç¢ºèª: ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³æŠ¼ä¸‹
    ã‚­ãƒ£ãƒ³ã‚»ãƒ«ç¢ºèª --> ä¸€è¦§ã‚¿ãƒ–: ç¢ºå®š/ã‚­ãƒ£ãƒ³ã‚»ãƒ«
```

---

## 5. CORSï¼ˆã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ï¼‰è¨­å®š

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆVercelï¼‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒç•°ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å­˜åœ¨ã™ã‚‹ãŸã‚ã€
Spring Boot å´ã§ CORS ã‚’è¨±å¯ã—ã¾ã™ã€‚

```
è¨±å¯ã‚ªãƒªã‚¸ãƒ³: ç’°å¢ƒå¤‰æ•° ALLOWED_ORIGINS ã§è¨­å®š
è¨±å¯ãƒ¡ã‚½ãƒƒãƒ‰: GET, POST, PUT, DELETE, OPTIONS
è¨±å¯ãƒ˜ãƒƒãƒ€ãƒ¼: *ï¼ˆã™ã¹ã¦ï¼‰
ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥: 3600ç§’ï¼ˆ1æ™‚é–“ï¼‰
```

---

## 6. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
spring/
â”œâ”€â”€ backend/                          # Spring Boot ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ pom.xml                       # Maven è¨­å®šï¼ˆä¾å­˜é–¢ä¿‚ç®¡ç†ï¼‰
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ main/
â”‚       â”‚   â”œâ”€â”€ java/com/bistrolumiere/reservation/
â”‚       â”‚   â”‚   â”œâ”€â”€ ReservationApplication.java   # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚       â”‚   â”‚   â”œâ”€â”€ config/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ CorsConfig.java           # CORS è¨­å®š
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ SecurityConfig.java       # Spring Security è¨­å®š
â”‚       â”‚   â”‚   â”œâ”€â”€ controller/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ ReservationController.java # REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚       â”‚   â”‚   â”œâ”€â”€ dto/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ ReservationRequest.java   # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ DTO
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ ReservationResponse.java  # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ DTO
â”‚       â”‚   â”‚   â”œâ”€â”€ entity/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ Reservation.java          # JPA ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
â”‚       â”‚   â”‚   â”œâ”€â”€ exception/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ BusinessException.java    # ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ ErrorResponse.java        # ã‚¨ãƒ©ãƒ¼ DTO
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ GlobalExceptionHandler.java # ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚       â”‚   â”‚   â”œâ”€â”€ repository/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ ReservationRepository.java # ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤
â”‚       â”‚   â”‚   â””â”€â”€ service/
â”‚       â”‚   â”‚       â””â”€â”€ ReservationService.java   # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚       â”‚   â””â”€â”€ resources/
â”‚       â”‚       â””â”€â”€ application.yml               # ã‚¢ãƒ—ãƒªè¨­å®šï¼ˆç’°å¢ƒå¤‰æ•°å‚ç…§ï¼‰
â”‚       â””â”€â”€ test/
â”‚           â”œâ”€â”€ java/com/bistrolumiere/reservation/
â”‚           â”‚   â”œâ”€â”€ controller/
â”‚           â”‚   â”‚   â””â”€â”€ ReservationControllerTest.java
â”‚           â”‚   â””â”€â”€ service/
â”‚           â”‚       â””â”€â”€ ReservationServiceTest.java
â”‚           â””â”€â”€ resources/
â”‚               â””â”€â”€ application-test.yml          # ãƒ†ã‚¹ãƒˆå°‚ç”¨è¨­å®šï¼ˆH2ä½¿ç”¨ï¼‰
â”œâ”€â”€ frontend/                         # Vercel ç”¨é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ style.css
â”‚   â””â”€â”€ app.js
â””â”€â”€ docs/                             # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â”œâ”€â”€ 01_è¦ä»¶å®šç¾©æ›¸.md
    â”œâ”€â”€ 02_åŸºæœ¬è¨­è¨ˆæ›¸.md
    â”œâ”€â”€ 03_è©³ç´°è¨­è¨ˆæ›¸.md
    â””â”€â”€ 04_å˜ä½“ãƒ»çµåˆãƒ»ç·åˆãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸.md
```
