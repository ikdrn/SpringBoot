# 01. 要件定義書

## Bistro Lumiere - レストラン座席予約システム

---

## 1. システムの目的

人気フレンチビストロ「Bistro Lumiere」の予約管理を**デジタル化**するためのWebシステムです。

現状は電話・紙台帳で予約管理を行っており、以下の課題があります：

| 課題 | 影響 |
|------|------|
| 予約台帳の記入漏れ・見間違い | ダブルブッキングの発生 |
| 電話応対時間に制約がある | 閉店後の予約を取れない機会損失 |
| 予約状況の集計が手作業 | 経営データの分析ができない |

本システムでこれらの課題を解消します。

---

## 2. 対象ユーザー

```
【ユーザー①: お客様（ゲスト）】
  - 誰でも予約フォームから予約・キャンセルができる
  - 会員登録・ログイン不要（今回はシンプル設計）

【ユーザー②: 将来の拡張】
  - スタッフ向けの管理画面（認証付き）は今回のスコープ外
```

---

## 3. 機能要件

### 3-1. お客様向け機能

| No. | 機能名 | 説明 |
|-----|--------|------|
| F-01 | 空席確認 | 日付・時間を選択して残席数を確認できる |
| F-02 | 予約作成 | 名前・メール・日時・人数・特別リクエストを入力して予約できる |
| F-03 | 予約一覧表示 | 全予約の一覧を確認できる |
| F-04 | 予約キャンセル | 予約番号を指定してキャンセルできる（論理削除） |

### 3-2. ビジネスルール（制約）

```
【予約ルール】
  R-01: 予約は当日から1ヶ月先まで。過去日付はNG。
  R-02: 1つの時間帯の最大予約組数は5組（5テーブル分）。
  R-03: 1テーブルあたり最大4名まで。
  R-04: キャンセルは論理削除（履歴は残す）。
  R-05: 満席時の予約は409 Conflictエラー。

【バリデーション】
  V-01: 名前: 必須, 最大100文字
  V-02: メール: 必須, 正しいメール形式
  V-03: 人数: 必須, 1〜4名
  V-04: 日付: 必須, 今日以降
  V-05: 時間: 必須
```

---

## 4. 非機能要件

### 4-1. パフォーマンス

| 項目 | 目標値 |
|------|--------|
| API レスポンスタイム | 通常時: 3秒以内（Neon 初回接続時: 最大10秒） |
| フロントエンドのローディング表示 | API 通信中は必ずスピナーを表示し、ユーザーを不安にさせない |

> **Neon（シンガポールリージョン）について**
> DBはNeon Serverless PostgreSQLを使用します。最寄りリージョンがシンガポールのため、
> 初回接続時（コールドスタート）に遅延が発生する場合があります。
> フロントエンドのローディング画面でUXを維持します。

### 4-2. セキュリティ

| 項目 | 対策 |
|------|------|
| SQLインジェクション | Spring Data JPAのプリペアドステートメント |
| XSS（クロスサイトスクリプティング） | `textContent`の使用、HTMLエスケープ |
| CSRF | REST APIなのでCSRF無効化（ステートレス設計） |
| 情報漏洩 | エラーレスポンスにスタックトレースを含めない |
| 認証情報の管理 | DB URLをハードコードせず環境変数を使用 |

### 4-3. 可用性・保守性

| 項目 | 内容 |
|------|------|
| ホスティング | バックエンド: クラウド（Railway/Renderなど）、フロントエンド: Vercel |
| データベース | Neon (Serverless PostgreSQL) |
| テスト | 単体テスト・結合テストで主要ビジネスロジックをカバー |
| ログ | SLF4J + Logback によるログ出力 |

---

## 5. システム境界（スコープ外）

以下は今回のスコープに含まれません：

- ユーザー認証・会員管理
- 管理者向け画面（売上集計、スタッフ管理）
- メール通知（予約確定・リマインダー）
- 決済機能
- 多言語対応
